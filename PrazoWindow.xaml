<Window x:Class="ManutMap.PrazoWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Painel de Prazos" Height="600" Width="920"
        WindowStartupLocation="CenterOwner"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{materialDesign:MaterialDesignFont}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <materialDesign:BundledTheme BaseTheme="Light" PrimaryColor="Blue" SecondaryColor="Indigo" />
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <Style TargetType="{x:Type DataGridColumnHeader}" BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <ComboBox x:Name="RegionalFilterCombo" Grid.Column="0" Margin="0,0,8,0"
                      materialDesign:HintAssist.Hint="Regional"
                      Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                      SelectionChanged="RegionalChanged"/>

            <ComboBox x:Name="RotaFilterCombo" Grid.Column="1" Margin="8,0" Width="100"
                      materialDesign:HintAssist.Hint="Rota"
                      Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                      SelectionChanged="FiltersChanged"/>

            <TextBox x:Name="DiasTextBox" Grid.Column="2" Margin="8,0" Width="80"
                     materialDesign:HintAssist.Hint="Dias"
                     Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                     PreviewTextInput="DiasTextBox_PreviewTextInput" TextChanged="FiltersChanged"/>

            <ComboBox x:Name="TipoPrazoCombo" Grid.Column="3" Margin="8,0,16,0"
                      materialDesign:HintAssist.Hint="Tipo de Prazo"
                      Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                      SelectionChanged="FiltersChanged"/>

            <Button x:Name="ShowFilteredButton" Grid.Column="4"
                    Content="Mostrar no Mapa"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Click="ShowFilteredButton_Click"
                    IsEnabled="{Binding ElementName=GridCorretivas, Path=HasItems}"/>
        </Grid>

        <TabControl Grid.Row="1" Style="{StaticResource MaterialDesignNavigatilRailTabControl}">
            <TabItem Header="Corretivas">
                <DataGrid x:Name="GridCorretivas"
                          IsReadOnly="True"
                          AutoGenerateColumns="False"
                          EnableRowVirtualization="True"
                          materialDesign:DataGridAssist.CellPadding="12 8"
                          materialDesign:DataGridAssist.ColumnHeaderPadding="8"
                          Style="{StaticResource MaterialDesignDataGrid}"
                          LoadingRow="GridCorretivas_LoadingRow">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="OS" Binding="{Binding NumOS}" Width="*"/>
                        <DataGridTextColumn Header="ID SIGFI" Binding="{Binding IdSigfi}" Width="*"/>
                        <DataGridTextColumn Header="Cliente" Binding="{Binding Cliente}" Width="2*"/>
                        <DataGridTextColumn Header="Abertura" Binding="{Binding Abertura, StringFormat='dd/MM/yyyy'}" Width="*"/>
                        <DataGridTextColumn Header="Dias Restantes" Binding="{Binding DiasRestantes}" Width="*"/>
                        <DataGridTemplateColumn Header="Mapa" Width="Auto">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                            Content="MAPA"
                                            Click="MapaCorretiva_Click"
                                            Tag="{Binding IdSigfi}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Preventivas">
                <DataGrid x:Name="GridPreventivas"
                          IsReadOnly="True"
                          AutoGenerateColumns="False"
                          EnableRowVirtualization="True"
                          materialDesign:DataGridAssist.CellPadding="13 8"
                          materialDesign:DataGridAssist.ColumnHeaderPadding="8"
                          Style="{StaticResource MaterialDesignDataGrid}"
                          LoadingRow="GridPreventivas_LoadingRow">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="OS" Binding="{Binding NumOS}" Width="*"/>
                        <DataGridTextColumn Header="ID SIGFI" Binding="{Binding IdSigfi}" Width="*"/>
                        <DataGridTextColumn Header="Cliente" Binding="{Binding Cliente}" Width="2*"/>
                        <DataGridTextColumn Header="Última" Binding="{Binding Ultima, StringFormat='dd/MM/yyyy'}" Width="*"/>
                        <DataGridTextColumn Header="Próxima" Binding="{Binding Proxima, StringFormat='dd/MM/yyyy'}" Width="*"/>
                        <DataGridTextColumn Header="Dias Restantes" Binding="{Binding DiasRestantes}" Width="*"/>
                        <DataGridTemplateColumn Header="Mapa" Width="Auto">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                            Content="MAPA"
                                            Click="MapaPreventiva_Click"
                                            Tag="{Binding IdSigfi}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>